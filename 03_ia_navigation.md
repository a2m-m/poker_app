# 3. IA（情報設計）/ 画面一覧 & ナビゲーション設計

## 3.1 IAの前提（このドキュメントのゴール）
- 「どの画面で何をするか」を固定し、実装時に **メイン画面が肥大化する事故**を防ぐ
- 画面遷移と、ゲームの状態遷移（Preflop→Flop…）を混同しない
- 用語：
  - **Route（ページ）**：URL（またはSPA内の画面）で切り替わる“主画面”
  - **別レイヤー**：Routeの上に重なる UI（モーダル/ドロワー/サイドシート）
  - **確認ダイアログ**：破壊的操作の確認。短く、原則1アクションで閉じる

---

## 3.2 画面一覧（Route一覧）
MVPのRouteは最小限。基本は **3ルート**で回す。

### R0: `/`（ホーム / 続きから / 新規）
**役割**
- 直近のゲームがあれば「続きから」
- 無ければ「新規ゲーム作成」へ誘導

**できること（MVP）**
- 新規ゲーム開始
- （任意）ローカル保存されたゲームの再開・破棄

---

### R1: `/setup`（ゲームセットアップ）
**役割**
- 人数・名前・初期スタック・SB/BB・ボタン初期位置など、ゲーム開始に必要な入力を完了する

**できること（MVP）**
- 人数（2〜9）選択
- プレイヤー名入力（重複は警告）
- 初期スタック設定
- SB/BB設定
- ボタン初期位置の決定（選択 or ランダム）
- 「ゲーム開始」で `/table` へ

**ここに置かない（別レイヤーへ）**
- 役一覧 / 判定ツール / ログ（まだ不要）

---

### R2: `/table`（テーブル画面：メイン）
**役割**
- “今の状況”と“次の手番”を提示し、アクション入力でゲームを進行する

**できること（MVP）**
- 次の手番表示（〇〇さんの番）
- 現在ラウンド表示（Preflop/Flop/Turn/River/Showdown）
- SB/BB・ボタン位置表示
- ポット、各プレイヤーのスタック/投入額/状態表示
- アクション入力（Check/Call/Bet/Raise/Fold + 金額）
- ラウンド遷移（フロップへ等）※実際のカードは物理でめくる
- ハンド終了処理（勝者へポット付与、次ハンドへ）
- Undo（直前1手）

**ここに置かない（別レイヤーへ）**
- 長文ルール説明
- 役一覧、勝者判定入力、詳細ログ、設定（全部“別レイヤー”）

---

## 3.3 別レイヤー扱い（Routeにしないもの）
テーブル画面の上に重ねる。閉じたら**必ずテーブルに戻る**。

### L1: アクションログ（モーダル or ドロワー）
**目的**：直前の流れ確認、Undoの判断材料  
**内容**：誰が何をしたか（時系列）、現在のto call等  
**操作**：閉じる、（将来）特定地点までUndoなど

---

### L2: 役一覧（チートシート）（モーダル）
**目的**：初心者が困ったときの参照  
**内容**：役の順位、簡単な例  
**注意**：テーブル進行を邪魔しない（常時表示しない）

---

### L3: 勝者判定ツール（モーダル）
**目的**：ショーダウンで「どっち勝ち？」を任意入力で解決  
**入力**：共有カード（0〜5）＋任意のプレイヤー手札（2）  
**出力**：役名、強さ、勝者（同点含む）  
**位置づけ**：通常フロー必須ではない（困ったら使う）

---

### L4: 設定（サイドシート）
**目的**：ゲーム途中の運用変更（ただしMVPは最小）  
**内容（MVP候補）**
- 音/バイブ等（もしあれば）
- “続きから”用の保存ON/OFF（任意）
- デバッグ情報（任意）
※ 初期は「ゲーム中のSB/BB変更」などは入れない（事故りやすい）

---

## 3.4 確認ダイアログ（破壊的操作）
- 「ハンドをリセット」
- 「ゲームを終了（ホームへ戻る）」
- 「保存データを破棄」

原則：**キャンセル**と**実行**の2択だけ。長文は書かない。

---

## 3.5 ナビゲーション設計（どう行き来するか）

### グローバルナビ（Route遷移）
- ホーム → セットアップ → テーブル が基本の一方向
- テーブルからホームに戻る場合は **確認ダイアログ**を挟む（進行中データが消える可能性があるため）

### テーブル内ナビ（別レイヤー）
テーブル画面には「ユーティリティ」入口を固定配置する（例：右上にアイコン列）。
- ログ
- 役一覧
- 判定ツール
- 設定

※ “何でもメイン画面に置かない”ため、情報/補助はここに逃がす。

---

## 3.6 状態遷移（ゲーム進行のステートマシン）
Route遷移とは別に、ゲームは下記の状態を持つ。

### ゲーム全体（GameState）
- `SETUP`：セットアップ中（/setup）
- `IN_GAME`：ゲーム進行中（/table）
- `PAUSED`：中断（MVPでは未実装でもOK。将来の保存再開で使う）

### ハンド進行（HandState）
- `HAND_INIT`：ブラインド徴収、ラウンド初期化
- `PREFLOP_BETTING`
- `FLOP_BETTING`
- `TURN_BETTING`
- `RIVER_BETTING`
- `SHOWDOWN`：勝者決定（判定ツールは任意）
- `HAND_END`：ポット付与、ボタンを進める、次ハンド準備

### ラウンド内（BettingRoundState）
- `AWAIT_ACTION`：誰かの入力待ち
- `ROUND_CLOSED`：全員が揃った/残り1人になった等でラウンド終了

---

## 3.7 画面遷移フロー（代表）

### 新規開始
`/` → `/setup` → `/table`

### ゲーム中（基本）
`/table`（別レイヤー：ログ/役一覧/判定/設定）  
※別レイヤーを閉じると常に `/table` に戻る

### ハンド終了
`/table` 内で `HAND_END` → 次ハンドの `HAND_INIT` へ（Routeは変えない）

### 終了
`/table` →（確認）→ `/`

---

## 3.8 MVPでの「禁止」ルール（IA観点）
- 役一覧や判定ツールを **常時表示しない**（別レイヤー固定）
- テーブル画面に「説明文」を積まない（ガイドは1行）
- **サイドポットは非対応**なので、サイドポット前提の詳細画面は作らない  
  （必要なら警告表示＋例外運用へ誘導は“別レイヤー/ダイアログ”で）
